name: Pull Request Labels
on:
  pull_request:
    types: [opened, labeled, unlabeled, synchronize]

permissions:
  id-token: write
  contents: read

jobs:
  test:
    name: test
    runs-on: ubuntu-latest
    steps:
      - id: 'auth'
        name: 'Authenticate to GCP'
        uses: 'google-github-actions/auth@v0.3.1'
        with:
            create_credentials_file: 'true'
            workload_identity_provider: 'principal://iam.googleapis.com/projects/54512176279/locations/global/workloadIdentityPools/github-com/providers/github-com'
            service_account: 'gsec-ma-cloud-metrics-iac@gcp-gsec-prod.iam.gserviceaccount.com'
      - id: 'list'
        run: |-
          curl https://iam.googleapis.com/v1/projects/54512176279/serviceAccounts \
            --header "Authorization: Bearer ${{ steps.auth.outputs.access_token }}"
